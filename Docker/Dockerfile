FROM docker.io/java:openjdk-8-jdk

ENV ACTIVATOR_VER 1.3.7

ENV JAVA_OPTS="-Xms512m -Xmx512m -XX:MetaspaceSize=64m"

RUN apt-get install -y unzip git-core

RUN cd /opt \
    && wget http://downloads.typesafe.com/typesafe-activator/${ACTIVATOR_VER}/typesafe-activator-${ACTIVATOR_VER}.zip \
    && unzip typesafe-activator-${ACTIVATOR_VER}.zip \
    && ln -s /opt/activator-dist-${ACTIVATOR_VER} /opt/activator \
    && rm -f /opt/typesafe-activator-${ACTIVATOR_VER}.zip \
    && ls /opt

RUN cd /opt \
    && git clone https://github.com/dimetron/OpenTrackerServer.git

WORKDIR /opt/OpenTrackerServer

RUN cd /opt/OpenTrackerServer \
    && /opt/activator/activator compile

# Expose ports.
EXPOSE 9999
EXPOSE 8080

# Define an entry point.
ENTRYPOINT ["/opt/activator/activator", "run", "-Dhttp.address=0.0.0.0"]